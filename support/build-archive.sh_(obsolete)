#!/usr/bin/env bash

# compiler for sherpa archives.

. vars.source || exit

echo -n 'building archive ... '

a=$target_path/$management_archive_file

[[ -e $a ]] && rm -f "$a"

tar --create --gzip --numeric-owner --file="$a" --directory="$support_path" "$objects_file" "$packages_file" "$management_file"

if [[ ! -s $a ]]; then
	ColourTextBrightRed "'$a' was not written"; echo
	exit 1
fi

rm -f "$objects_file" "$packages_file" "$management_file"
chmod 444 "$a"

ShowDone
exit 0
